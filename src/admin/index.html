<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="HA4E content editor â€“ sign in to edit site content.">
  <title>HA4E Content Editor</title>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <link href="/admin/config.yml" type="text/yaml" rel="cms-config-url">
  <script>
    (function() {
      var retryDelays = [0, 200, 500, 1000, 1500, 2000, 3000, 4000, 5000];
      function dispatchAuth(msg) {
        if (!msg) return;
        window.dispatchEvent(new MessageEvent('message', { data: msg, origin: window.location.origin }));
      }
      function tryApplyPending() {
        try {
          var msg = localStorage.getItem('cms-oauth-pending');
          if (msg) {
            dispatchAuth(msg);
            return true;
          }
        } catch (e) {}
        return false;
      }
      function applyPendingAndClear() {
        try {
          var msg = localStorage.getItem('cms-oauth-pending');
          if (msg) {
            retryDelays.forEach(function(delay) {
              setTimeout(function() { dispatchAuth(msg); }, delay);
            });
            try { localStorage.removeItem('cms-oauth-pending'); } catch (e) {}
          }
        } catch (e) {}
      }
      function retryDispatch(msg) {
        retryDelays.forEach(function(delay) {
          setTimeout(function() { dispatchAuth(msg); }, delay);
        });
      }
      window.addEventListener('storage', function(e) {
        if (e.key === 'cms-oauth-pending' && e.newValue) {
          retryDispatch(e.newValue);
        }
      });
      window.addEventListener('focus', function() {
        setTimeout(applyPendingAndClear, 100);
        setTimeout(applyPendingAndClear, 500);
      });
      retryDelays.forEach(function(delay) {
        setTimeout(function() {
          try {
            var msg = localStorage.getItem('cms-oauth-pending');
            if (msg) retryDispatch(msg);
          } catch (e) {}
        }, delay);
      });
    })();
  </script>
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js" defer></script>
</head>
<body>
  <main id="nc-root" role="main"></main>
</body>
</html>
